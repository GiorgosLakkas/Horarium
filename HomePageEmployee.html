<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard with Calendar</title>
  <link rel="stylesheet" href="calendar.css">
</head>
<body>
  <aside class="sidebar">
    <div class="logo">YourLogo</div>
    <nav>
      <ul>
        <li><a href="#">Make a Request</a></li>
        <li><a href="#">Account Settings</a></li>
        <li><a href="#">Simple Stats</a></li>
      </ul>
    </nav>
  </aside>

  <div class="top-bar">
    <div class="profile-section">
      <img src="profile.jpg" alt="User Profile" class="profile-pic">
      <div class="greeting-text">
        <h1>Welcome back, <span id="user-name">First Last</span></h1>
        <p class="greeting-subtext">Here’s what’s happening today at a glance</p>
      </div>
    </div>
  </div>

  <main class="main-content">
    <h2>Dashboard Overview</h2>
    <p>Start by selecting an option on the left or check your latest updates here.</p>

    <!-- Embed the calendar -->
    <div class="wrap">
      <div class="calendar-card">
        <div class="sidebar">
          <div class="now">
            <div class="clock" id="clock">--:--:--</div>
            <div class="date-line" id="dateline">Loading date...</div>
          </div>

          <div class="controls">
            <button id="prev">◀ Prev</button>
            <button id="today" class="btn-primary">Today</button>
            <button id="next">Next ▶</button>
          </div>

          <div class="legend"><span class="dot event-dot"></span><span>Events</span></div>
          <div class="hint">Click a day to add a quick note (stored locally). Click event to delete.</div>
        </div>

        <div class="main">
          <div class="header">
            <div class="month-title" id="monthTitle">Month Year</div>
            <div class="nav">
              <select id="viewSelect" title="Jump to month"></select>
            </div>
          </div>

          <div class="grid" id="calendarGrid">
            <div class="weekdays" id="weekdays"></div>
            <div class="days" id="days"></div>
          </div>
        </div>
      </div>
    </div>

  </main>

  <footer class="footer">© 2025 HORARIUM. All rights reserved.</footer>

  <script>
    const userName = 'Jeanne Foster';
    document.getElementById('user-name').textContent = userName;
  </script>

  <!-- Calendar JS -->
  <script>
    (function(){
      const $ = id => document.getElementById(id);
      const pad = n => n.toString().padStart(2,'0');
      let current = new Date(); current.setDate(1);
      const LS_KEY = 'realtime_calendar_events_v1';
      function loadEvents(){ try{ return JSON.parse(localStorage.getItem(LS_KEY)||'{}') }catch(e){return {}} }
      function saveEvents(ev){ localStorage.setItem(LS_KEY, JSON.stringify(ev)) }
      let events = loadEvents();

      const monthTitle = $('monthTitle');
      const weekdaysEl = $('weekdays');
      const daysEl = $('days');
      const clockEl = $('clock');
      const dateLine = $('dateline');
      const prevBtn = $('prev'); const nextBtn = $('next'); const todayBtn = $('today'); const viewSelect = $('viewSelect');

      const WEEKDAYS = ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];
      function renderWeekdays(){ weekdaysEl.innerHTML = WEEKDAYS.map(d=>`<div class="weekday">${d}</div>`).join('') }

      function populateMonthSelect(){
        const now = new Date();
        const startYear = now.getFullYear()-6; const endYear = now.getFullYear()+6;
        const opts = [];
        for(let y=startYear;y<=endYear;y++){
          for(let m=0;m<12;m++){
            const d = new Date(y,m,1);
            opts.push({v:`${y}-${pad(m+1)}-01`, label: d.toLocaleString(undefined,{month:'long',year:'numeric'})});
          }
        }
        viewSelect.innerHTML = opts.map(o=>`<option value="${o.v}">${o.label}</option>`).join('')
      }

      function render(){
        const year = current.getFullYear();
        const month = current.getMonth();
        monthTitle.textContent = current.toLocaleString(undefined,{month:'long', year:'numeric'});
        viewSelect.value = `${year}-${pad(month+1)}-01`;
        daysEl.innerHTML = '';

        const firstDayIndex = new Date(year,month,1).getDay();
        const daysInMonth = new Date(year,month+1,0).getDate();
        const prevMonthDays = new Date(year,month,0).getDate();

        for(let i=0;i<42;i++){
          const cell = document.createElement('div'); cell.className='day';
          const slotIndex=i;
          let dateNum, cellDate, inactive=false;
          const dayOffset=slotIndex-firstDayIndex;

          if(dayOffset<0){ dateNum=prevMonthDays+dayOffset+1; cellDate=new Date(year,month-1,dateNum); inactive=true; }
          else if(dayOffset>=daysInMonth){ dateNum=dayOffset-daysInMonth+1; cellDate=new Date(year,month+1,dateNum); inactive=true; }
          else{ dateNum=dayOffset+1; cellDate=new Date(year,month,dateNum); }

          const iso = cellDate.toISOString().slice(0,10);
          cell.innerHTML = `<div class="num">${dateNum}</div><div class="events" data-date="${iso}"></div>`;
          if(inactive) cell.classList.add('inactive');

          const today=new Date();
          if(cellDate.getFullYear()===today.getFullYear() && cellDate.getMonth()===today.getMonth() && cellDate.getDate()===today.getDate()){ cell.classList.add('today'); }

          cell.addEventListener('click',()=>{ 
            const dateKey=iso;
            const note=prompt('Add a quick note for '+dateKey+' (leave empty to cancel)');
            if(note&&note.trim()){ events[dateKey]=events[dateKey]||[]; events[dateKey].push(note.trim()); saveEvents(events); render(); }
          });

          daysEl.appendChild(cell);
        }

        const eventEls = daysEl.querySelectorAll('.events');
        eventEls.forEach((e)=>{
          const dateKey=e.dataset.date;
          const list=events[dateKey]||[];
          e.innerHTML='';
          list.slice(0,3).forEach((note,idx)=>{
            const evEl=document.createElement('div'); evEl.className='event'; evEl.textContent=note;
            evEl.title=note+'\n(click to delete)';
            evEl.addEventListener('click',(ev)=>{
              ev.stopPropagation();
              if(confirm('Delete this event?')){ events[dateKey].splice(idx,1); if(events[dateKey].length===0) delete events[dateKey]; saveEvents(events); render(); }
            });
            e.appendChild(evEl);
          });
          if(list.length>3){
            const more=document.createElement('div'); more.className='event'; more.textContent=`+${list.length-3} more`;
            more.title=list.slice(3).join('\n');
            more.addEventListener('click',(ev)=>{ ev.stopPropagation(); alert(list.join('\n')) });
            e.appendChild(more);
          }
        });
      }

      function tick(){ const now=new Date(); clockEl.textContent=`${pad(now.getHours())}:${pad(now.getMinutes())}:${pad(now.getSeconds())}`; dateLine.textContent=now.toLocaleString(undefined,{weekday:'long', month:'long', day:'numeric', year:'numeric'}); }

      prevBtn.addEventListener('click',()=>{ current.setMonth(current.getMonth()-1); render(); });
      nextBtn.addEventListener('click',()=>{ current.setMonth(current.getMonth()+1); render(); });
      todayBtn.addEventListener('click',()=>{ const n=new Date(); current.setFullYear(n.getFullYear(), n.getMonth(), 1); render(); });
      viewSelect.addEventListener('change',(e)=>{ const [y,m]=e.target.value.split('-'); current.setFullYear(parseInt(y), parseInt(m)-1, 1); render(); });

      renderWeekdays(); populateMonthSelect(); render(); tick();
      setInterval(tick,1000);

      window.RealtimeCalendar={
        goTo:(y,m)=>{current.setFullYear(y,m-1,1);render();},
        exportEvents:()=>JSON.stringify(events),
        importEvents:(json)=>{ try{ events=JSON.parse(json); saveEvents(events); render(); return true }catch(e){return false} }
      };
    })();
  </script>
</body>
</html>
